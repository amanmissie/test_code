#include <iostream>
#include <xlnt/xlnt.hpp>

int main() {
    try {
        xlnt::workbook wb;
        wb.load("test.xlsx");  // Replace with your Excel file

        xlnt::worksheet ws = wb.active_sheet();

        int rowCount = 0;
        bool isFirstRow = true;

        for (auto row : ws.rows(false)) {
            if (isFirstRow) {
                isFirstRow = false;  // Skip the first row (assumed header)
                continue;
            }

            bool hasData = false;
            for (auto cell : row) {
                if (!cell.to_string().empty()) {
                    hasData = true;
                    break;
                }
            }

            if (hasData) {
                ++rowCount;
            }
        }

        std::cout << "Number of data rows (excluding header): " << rowCount << std::endl;
    } catch (const std::exception &e) {
        std::cerr << "Error: " << e.what() << std::endl;
        return 1;
    }

    return 0;
}
